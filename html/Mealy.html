<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Mealy</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Composable Mealy machines</a>

<a id="31" class="Symbol">{-#</a> <a id="35" class="Keyword">OPTIONS</a> <a id="43" class="Pragma">--safe</a> <a id="50" class="Pragma">--without-K</a> <a id="62" class="Symbol">#-}</a>

<a id="67" class="Symbol">{-#</a> <a id="71" class="Keyword">OPTIONS</a> <a id="79" class="Pragma">--guardedness</a> <a id="93" class="Symbol">#-}</a>

<a id="98" class="Keyword">module</a> <a id="105" href="Mealy.html" class="Module">Mealy</a> <a id="111" class="Keyword">where</a>

<a id="118" class="Keyword">open</a> <a id="123" class="Keyword">import</a> <a id="130" href="Data.Sum.html" class="Module">Data.Sum</a>     <a id="143" class="Keyword">hiding</a> <a id="150" class="Symbol">(</a><a id="151" href="Data.Sum.Base.html#1362" class="Function">map</a><a id="154" class="Symbol">)</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Product.html" class="Module">Data.Product</a> <a id="181" class="Keyword">hiding</a> <a id="188" class="Symbol">(</a><a id="189" href="Data.Product.html#2486" class="Function">map</a><a id="192" class="Symbol">)</a> <a id="194" class="Keyword">renaming</a> <a id="203" class="Symbol">(</a><a id="204" href="Data.Product.html#2625" class="Function">map₁</a> <a id="209" class="Symbol">to</a> <a id="Product.map₁"></a><a id="212" href="Mealy.html#212" class="Function">map×₁</a><a id="217" class="Symbol">;</a> <a id="219" href="Data.Product.html#5317" class="Function">swap</a> <a id="224" class="Symbol">to</a> <a id="Product.swap"></a><a id="227" href="Mealy.html#227" class="Function">swap×</a><a id="232" class="Symbol">)</a>
<a id="234" class="Keyword">open</a> <a id="239" class="Keyword">import</a> <a id="246" href="Data.Unit.html" class="Module">Data.Unit</a>

<a id="257" class="Keyword">private</a>
  <a id="267" class="Keyword">variable</a>
    <a id="280" href="Mealy.html#280" class="Generalizable">A</a> <a id="282" href="Mealy.html#282" class="Generalizable">B</a> <a id="284" href="Mealy.html#284" class="Generalizable">C</a> <a id="286" href="Mealy.html#286" class="Generalizable">D</a> <a id="288" class="Symbol">:</a> <a id="290" class="PrimitiveType">Set</a>

<a id="295" class="Keyword">infix</a> <a id="301" class="Number">0</a> <a id="303" href="Mealy.html#442" class="Record Operator">_⇨_</a>

<a id="308" class="Comment">-- State machine synchronously mapping from List a to List b.</a>
<a id="370" class="Comment">-- For composability, the state type is not visible in the type.</a>
<a id="435" class="Keyword">record</a> <a id="_⇨_"></a><a id="442" href="Mealy.html#442" class="Record Operator">_⇨_</a> <a id="446" class="Symbol">(</a><a id="447" href="Mealy.html#447" class="Bound">A</a> <a id="449" href="Mealy.html#449" class="Bound">B</a> <a id="451" class="Symbol">:</a> <a id="453" class="PrimitiveType">Set</a><a id="456" class="Symbol">)</a> <a id="458" class="Symbol">:</a> <a id="460" class="PrimitiveType">Set₁</a> <a id="465" class="Keyword">where</a>
  <a id="473" class="Keyword">constructor</a> <a id="mealy"></a><a id="485" href="Mealy.html#485" class="InductiveConstructor">mealy</a>
  <a id="493" class="Keyword">field</a>
    <a id="503" class="Symbol">{</a> <a id="_⇨_.State"></a><a id="505" href="Mealy.html#505" class="Field">State</a> <a id="511" class="Symbol">}</a> <a id="513" class="Symbol">:</a> <a id="515" class="PrimitiveType">Set</a>
    <a id="_⇨_.start"></a><a id="523" href="Mealy.html#523" class="Field">start</a> <a id="529" class="Symbol">:</a> <a id="531" href="Mealy.html#505" class="Field">State</a>
    <a id="_⇨_.transition"></a><a id="541" href="Mealy.html#541" class="Field">transition</a> <a id="552" class="Symbol">:</a> <a id="554" href="Mealy.html#447" class="Bound">A</a> <a id="556" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="558" href="Mealy.html#505" class="Field">State</a> <a id="564" class="Symbol">→</a> <a id="566" href="Mealy.html#449" class="Bound">B</a> <a id="568" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="570" href="Mealy.html#505" class="Field">State</a>

<a id="577" class="Comment">-- Mapping a function (empty state, i.e., combinational logic)</a>
<a id="arr"></a><a id="640" href="Mealy.html#640" class="Function">arr</a> <a id="644" class="Symbol">:</a> <a id="646" class="Symbol">(</a><a id="647" href="Mealy.html#280" class="Generalizable">A</a> <a id="649" class="Symbol">→</a> <a id="651" href="Mealy.html#282" class="Generalizable">B</a><a id="652" class="Symbol">)</a> <a id="654" class="Symbol">→</a> <a id="656" class="Symbol">(</a><a id="657" href="Mealy.html#280" class="Generalizable">A</a> <a id="659" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="661" href="Mealy.html#282" class="Generalizable">B</a><a id="662" class="Symbol">)</a>
<a id="664" href="Mealy.html#640" class="Function">arr</a> <a id="668" href="Mealy.html#668" class="Bound">f</a> <a id="670" class="Symbol">=</a> <a id="672" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="678" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="681" class="Symbol">(</a><a id="682" href="Mealy.html#212" class="Function">map×₁</a> <a id="688" href="Mealy.html#668" class="Bound">f</a><a id="689" class="Symbol">)</a>
                 <a id="708" class="Comment">-- λ (a , tt) → f a , tt</a>

<a id="734" class="Comment">-- Sequential composition</a>
<a id="760" class="Keyword">infixr</a> <a id="767" class="Number">9</a> <a id="769" href="Mealy.html#773" class="Function Operator">_∘_</a>
<a id="_∘_"></a><a id="773" href="Mealy.html#773" class="Function Operator">_∘_</a> <a id="777" class="Symbol">:</a> <a id="779" class="Symbol">(</a><a id="780" href="Mealy.html#282" class="Generalizable">B</a> <a id="782" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="784" href="Mealy.html#284" class="Generalizable">C</a><a id="785" class="Symbol">)</a> <a id="787" class="Symbol">→</a> <a id="789" class="Symbol">(</a><a id="790" href="Mealy.html#280" class="Generalizable">A</a> <a id="792" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="794" href="Mealy.html#282" class="Generalizable">B</a><a id="795" class="Symbol">)</a> <a id="797" class="Symbol">→</a> <a id="799" class="Symbol">(</a><a id="800" href="Mealy.html#280" class="Generalizable">A</a> <a id="802" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="804" href="Mealy.html#284" class="Generalizable">C</a><a id="805" class="Symbol">)</a>
<a id="807" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="813" href="Mealy.html#813" class="Bound">t₀</a> <a id="816" href="Mealy.html#816" class="Bound">g</a> <a id="818" href="Mealy.html#773" class="Function Operator">∘</a> <a id="820" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="826" href="Mealy.html#826" class="Bound">s₀</a> <a id="829" href="Mealy.html#829" class="Bound">f</a> <a id="831" class="Symbol">=</a> <a id="833" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="839" class="Symbol">(</a><a id="840" href="Mealy.html#826" class="Bound">s₀</a> <a id="843" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="845" href="Mealy.html#813" class="Bound">t₀</a><a id="847" class="Symbol">)</a> <a id="849" class="Symbol">λ</a> <a id="851" class="Symbol">(</a><a id="852" href="Mealy.html#852" class="Bound">a</a> <a id="854" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="856" class="Symbol">(</a><a id="857" href="Mealy.html#857" class="Bound">s</a> <a id="859" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="861" href="Mealy.html#861" class="Bound">t</a><a id="862" class="Symbol">))</a> <a id="865" class="Symbol">→</a>
 <a id="868" class="Keyword">let</a> <a id="872" href="Mealy.html#872" class="Bound">b</a> <a id="874" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="876" href="Mealy.html#876" class="Bound">s′</a> <a id="879" class="Symbol">=</a> <a id="881" href="Mealy.html#829" class="Bound">f</a> <a id="883" class="Symbol">(</a><a id="884" href="Mealy.html#852" class="Bound">a</a> <a id="886" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="888" href="Mealy.html#857" class="Bound">s</a><a id="889" class="Symbol">)</a>
     <a id="896" href="Mealy.html#896" class="Bound">c</a> <a id="898" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="900" href="Mealy.html#900" class="Bound">t′</a> <a id="903" class="Symbol">=</a> <a id="905" href="Mealy.html#816" class="Bound">g</a> <a id="907" class="Symbol">(</a><a id="908" href="Mealy.html#872" class="Bound">b</a> <a id="910" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="912" href="Mealy.html#861" class="Bound">t</a><a id="913" class="Symbol">)</a>
 <a id="916" class="Keyword">in</a>
    <a id="923" href="Mealy.html#896" class="Bound">c</a> <a id="925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="927" class="Symbol">(</a><a id="928" href="Mealy.html#876" class="Bound">s′</a> <a id="931" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="933" href="Mealy.html#900" class="Bound">t′</a><a id="935" class="Symbol">)</a>

<a id="938" class="Comment">-- Parallel composition / product tensor</a>
<a id="979" class="Keyword">infixr</a> <a id="986" class="Number">7</a> <a id="988" href="Mealy.html#992" class="Function Operator">_⊗_</a>
<a id="_⊗_"></a><a id="992" href="Mealy.html#992" class="Function Operator">_⊗_</a> <a id="996" class="Symbol">:</a> <a id="998" class="Symbol">(</a><a id="999" href="Mealy.html#280" class="Generalizable">A</a> <a id="1001" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1003" href="Mealy.html#284" class="Generalizable">C</a><a id="1004" class="Symbol">)</a> <a id="1006" class="Symbol">→</a> <a id="1008" class="Symbol">(</a><a id="1009" href="Mealy.html#282" class="Generalizable">B</a> <a id="1011" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1013" href="Mealy.html#286" class="Generalizable">D</a><a id="1014" class="Symbol">)</a> <a id="1016" class="Symbol">→</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Mealy.html#280" class="Generalizable">A</a> <a id="1021" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1023" href="Mealy.html#282" class="Generalizable">B</a> <a id="1025" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1027" href="Mealy.html#284" class="Generalizable">C</a> <a id="1029" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1031" href="Mealy.html#286" class="Generalizable">D</a><a id="1032" class="Symbol">)</a>
<a id="1034" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1040" href="Mealy.html#1040" class="Bound">s₀</a> <a id="1043" href="Mealy.html#1043" class="Bound">f</a> <a id="1045" href="Mealy.html#992" class="Function Operator">⊗</a> <a id="1047" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1053" href="Mealy.html#1053" class="Bound">t₀</a> <a id="1056" href="Mealy.html#1056" class="Bound">g</a> <a id="1058" class="Symbol">=</a> <a id="1060" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Mealy.html#1040" class="Bound">s₀</a> <a id="1070" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1072" href="Mealy.html#1053" class="Bound">t₀</a><a id="1074" class="Symbol">)</a> <a id="1076" class="Symbol">λ</a> <a id="1078" class="Symbol">((</a><a id="1080" href="Mealy.html#1080" class="Bound">a</a> <a id="1082" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1084" href="Mealy.html#1084" class="Bound">b</a><a id="1085" class="Symbol">)</a> <a id="1087" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Mealy.html#1090" class="Bound">s</a> <a id="1092" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1094" href="Mealy.html#1094" class="Bound">t</a><a id="1095" class="Symbol">))</a> <a id="1098" class="Symbol">→</a>
  <a id="1102" class="Keyword">let</a> <a id="1106" href="Mealy.html#1106" class="Bound">c</a> <a id="1108" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1110" href="Mealy.html#1110" class="Bound">s′</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="Mealy.html#1043" class="Bound">f</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Mealy.html#1080" class="Bound">a</a> <a id="1120" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1122" href="Mealy.html#1090" class="Bound">s</a><a id="1123" class="Symbol">)</a>
      <a id="1131" href="Mealy.html#1131" class="Bound">d</a> <a id="1133" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1135" href="Mealy.html#1135" class="Bound">t′</a> <a id="1138" class="Symbol">=</a> <a id="1140" href="Mealy.html#1056" class="Bound">g</a> <a id="1142" class="Symbol">(</a><a id="1143" href="Mealy.html#1084" class="Bound">b</a> <a id="1145" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1147" href="Mealy.html#1094" class="Bound">t</a><a id="1148" class="Symbol">)</a>
  <a id="1152" class="Keyword">in</a>
    <a id="1159" class="Symbol">(</a><a id="1160" href="Mealy.html#1106" class="Bound">c</a> <a id="1162" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1164" href="Mealy.html#1131" class="Bound">d</a><a id="1165" class="Symbol">)</a> <a id="1167" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1169" class="Symbol">(</a><a id="1170" href="Mealy.html#1110" class="Bound">s′</a> <a id="1173" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1175" href="Mealy.html#1135" class="Bound">t′</a><a id="1177" class="Symbol">)</a>

<a id="1180" class="Comment">-- Conditional/choice composition / coproduct tensor</a>
<a id="1233" class="Keyword">infixr</a> <a id="1240" class="Number">6</a> <a id="1242" href="Mealy.html#1246" class="Function Operator">_⊕_</a>
<a id="_⊕_"></a><a id="1246" href="Mealy.html#1246" class="Function Operator">_⊕_</a> <a id="1250" class="Symbol">:</a> <a id="1252" class="Symbol">(</a><a id="1253" href="Mealy.html#280" class="Generalizable">A</a> <a id="1255" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1257" href="Mealy.html#284" class="Generalizable">C</a><a id="1258" class="Symbol">)</a> <a id="1260" class="Symbol">→</a> <a id="1262" class="Symbol">(</a><a id="1263" href="Mealy.html#282" class="Generalizable">B</a> <a id="1265" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1267" href="Mealy.html#286" class="Generalizable">D</a><a id="1268" class="Symbol">)</a> <a id="1270" class="Symbol">→</a> <a id="1272" class="Symbol">((</a><a id="1274" href="Mealy.html#280" class="Generalizable">A</a> <a id="1276" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1278" href="Mealy.html#282" class="Generalizable">B</a><a id="1279" class="Symbol">)</a> <a id="1281" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1283" class="Symbol">(</a><a id="1284" href="Mealy.html#284" class="Generalizable">C</a> <a id="1286" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1288" href="Mealy.html#286" class="Generalizable">D</a><a id="1289" class="Symbol">))</a>
<a id="1292" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1298" href="Mealy.html#1298" class="Bound">s₀</a> <a id="1301" href="Mealy.html#1301" class="Bound">f</a> <a id="1303" href="Mealy.html#1246" class="Function Operator">⊕</a> <a id="1305" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1311" href="Mealy.html#1311" class="Bound">t₀</a> <a id="1314" href="Mealy.html#1314" class="Bound">g</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Mealy.html#1298" class="Bound">s₀</a> <a id="1328" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1330" href="Mealy.html#1311" class="Bound">t₀</a><a id="1332" class="Symbol">)</a>
  <a id="1336" class="Symbol">λ</a> <a id="1338" class="Symbol">{</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1346" href="Mealy.html#1346" class="Bound">a</a> <a id="1348" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1350" class="Symbol">(</a><a id="1351" href="Mealy.html#1351" class="Bound">s</a> <a id="1353" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1355" href="Mealy.html#1355" class="Bound">t</a><a id="1356" class="Symbol">))</a> <a id="1359" class="Symbol">→</a> <a id="1361" class="Keyword">let</a> <a id="1365" href="Mealy.html#1365" class="Bound">c</a> <a id="1367" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1369" href="Mealy.html#1369" class="Bound">s′</a> <a id="1372" class="Symbol">=</a> <a id="1374" href="Mealy.html#1301" class="Bound">f</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Mealy.html#1346" class="Bound">a</a> <a id="1379" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1381" href="Mealy.html#1351" class="Bound">s</a><a id="1382" class="Symbol">)</a> <a id="1384" class="Keyword">in</a> <a id="1387" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1392" href="Mealy.html#1365" class="Bound">c</a> <a id="1394" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Mealy.html#1369" class="Bound">s′</a> <a id="1400" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1402" href="Mealy.html#1355" class="Bound">t</a><a id="1403" class="Symbol">)</a>
    <a id="1409" class="Symbol">;</a> <a id="1411" class="Symbol">(</a><a id="1412" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1417" href="Mealy.html#1417" class="Bound">b</a> <a id="1419" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1421" class="Symbol">(</a><a id="1422" href="Mealy.html#1422" class="Bound">s</a> <a id="1424" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1426" href="Mealy.html#1426" class="Bound">t</a><a id="1427" class="Symbol">))</a> <a id="1430" class="Symbol">→</a> <a id="1432" class="Keyword">let</a> <a id="1436" href="Mealy.html#1436" class="Bound">d</a> <a id="1438" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1440" href="Mealy.html#1440" class="Bound">t′</a> <a id="1443" class="Symbol">=</a> <a id="1445" href="Mealy.html#1314" class="Bound">g</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Mealy.html#1417" class="Bound">b</a> <a id="1450" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1452" href="Mealy.html#1426" class="Bound">t</a><a id="1453" class="Symbol">)</a> <a id="1455" class="Keyword">in</a> <a id="1458" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1463" href="Mealy.html#1436" class="Bound">d</a> <a id="1465" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1467" class="Symbol">(</a><a id="1468" href="Mealy.html#1422" class="Bound">s</a>  <a id="1471" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1473" href="Mealy.html#1440" class="Bound">t′</a><a id="1475" class="Symbol">)</a> <a id="1477" class="Symbol">}</a>

<a id="1480" class="Comment">-- Cons (memory/register)</a>
<a id="delay"></a><a id="1506" href="Mealy.html#1506" class="Function">delay</a> <a id="1512" class="Symbol">:</a> <a id="1514" href="Mealy.html#280" class="Generalizable">A</a> <a id="1516" class="Symbol">→</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Mealy.html#280" class="Generalizable">A</a> <a id="1521" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1523" href="Mealy.html#280" class="Generalizable">A</a><a id="1524" class="Symbol">)</a>
<a id="1526" href="Mealy.html#1506" class="Function">delay</a> <a id="1532" href="Mealy.html#1532" class="Bound">a₀</a> <a id="1535" class="Symbol">=</a> <a id="1537" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1543" href="Mealy.html#1532" class="Bound">a₀</a> <a id="1546" href="Mealy.html#227" class="Function">swap×</a>
                    <a id="1572" class="Comment">-- (λ (next , prev) → prev , next)</a>

<a id="scanl"></a><a id="1608" href="Mealy.html#1608" class="Function">scanl</a> <a id="1614" class="Symbol">:</a> <a id="1616" class="Symbol">(</a><a id="1617" href="Mealy.html#282" class="Generalizable">B</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Mealy.html#280" class="Generalizable">A</a> <a id="1623" class="Symbol">→</a> <a id="1625" href="Mealy.html#282" class="Generalizable">B</a><a id="1626" class="Symbol">)</a> <a id="1628" class="Symbol">→</a> <a id="1630" href="Mealy.html#282" class="Generalizable">B</a> <a id="1632" class="Symbol">→</a> <a id="1634" href="Mealy.html#280" class="Generalizable">A</a> <a id="1636" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1638" href="Mealy.html#282" class="Generalizable">B</a>
<a id="1640" href="Mealy.html#1608" class="Function">scanl</a> <a id="1646" href="Mealy.html#1646" class="Bound">f</a> <a id="1648" href="Mealy.html#1648" class="Bound">s₀</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1659" href="Mealy.html#1648" class="Bound">s₀</a> <a id="1662" class="Symbol">(λ</a> <a id="1665" class="Symbol">(</a><a id="1666" href="Mealy.html#1666" class="Bound">a</a> <a id="1668" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1670" href="Mealy.html#1670" class="Bound">s</a><a id="1671" class="Symbol">)</a> <a id="1673" class="Symbol">→</a> <a id="1675" href="Mealy.html#1670" class="Bound">s</a> <a id="1677" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1679" href="Mealy.html#1646" class="Bound">f</a> <a id="1681" href="Mealy.html#1670" class="Bound">s</a> <a id="1683" href="Mealy.html#1666" class="Bound">a</a><a id="1684" class="Symbol">)</a>

<a id="1687" class="Comment">-- Specification via denotational homomorphisms</a>
<a id="1735" class="Keyword">module</a> <a id="AsVecFun"></a><a id="1742" href="Mealy.html#1742" class="Module">AsVecFun</a> <a id="1751" class="Keyword">where</a>

  <a id="1760" class="Keyword">open</a> <a id="1765" class="Keyword">import</a> <a id="1772" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1810" class="Keyword">hiding</a> <a id="1817" class="Symbol">(</a><a id="1818" href="Relation.Binary.PropositionalEquality.html#1471" class="Function Operator">_≗_</a><a id="1821" class="Symbol">)</a>
  <a id="1825" class="Keyword">open</a> <a id="1830" href="Relation.Binary.PropositionalEquality.Core.html#2751" class="Module">≡-Reasoning</a>
  <a id="1844" class="Keyword">open</a> <a id="1849" class="Keyword">import</a> <a id="1856" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="1865" class="Keyword">hiding</a> <a id="1872" class="Symbol">(</a><a id="1873" href="Data.Vec.Base.html#2541" class="Function">map</a><a id="1876" class="Symbol">)</a>

  <a id="1881" class="Keyword">import</a> <a id="1888" href="VecFun.html" class="Module">VecFun</a> <a id="1895" class="Symbol">as</a> <a id="1898" class="Module">◇</a>
  <a id="1902" class="Keyword">open</a> <a id="1907" href="VecFun.html" class="Module">◇</a> <a id="1909" class="Keyword">using</a> <a id="1915" class="Symbol">(</a><a id="1916" href="VecFun.html#547" class="Function Operator">_↠_</a><a id="1919" class="Symbol">;</a> <a id="1921" href="VecFun.html#616" class="Function Operator">_≗_</a><a id="1924" class="Symbol">)</a>

  <a id="AsVecFun.⟦_⟧"></a><a id="1929" href="Mealy.html#1929" class="Function Operator">⟦_⟧</a> <a id="1933" class="Symbol">:</a> <a id="1935" class="Symbol">(</a><a id="1936" href="Mealy.html#280" class="Generalizable">A</a> <a id="1938" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="1940" href="Mealy.html#282" class="Generalizable">B</a><a id="1941" class="Symbol">)</a> <a id="1943" class="Symbol">→</a> <a id="1945" class="Symbol">(</a><a id="1946" href="Mealy.html#280" class="Generalizable">A</a> <a id="1948" href="VecFun.html#547" class="Function Operator">↠</a> <a id="1950" href="Mealy.html#282" class="Generalizable">B</a><a id="1951" class="Symbol">)</a>
  <a id="1955" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="1957" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1963" class="Symbol">_</a> <a id="1965" class="Symbol">_</a> <a id="1967" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="1969" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="1972" class="Symbol">=</a> <a id="1974" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a>
  <a id="1979" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="1981" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="1987" href="Mealy.html#1987" class="Bound">s</a> <a id="1989" href="Mealy.html#1989" class="Bound">f</a> <a id="1991" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="1993" class="Symbol">(</a><a id="1994" href="Mealy.html#1994" class="Bound">a</a> <a id="1996" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="1998" href="Mealy.html#1998" class="Bound">as</a><a id="2000" class="Symbol">)</a> <a id="2002" class="Symbol">=</a> <a id="2004" class="Keyword">let</a> <a id="2008" href="Mealy.html#2008" class="Bound">b</a> <a id="2010" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2012" href="Mealy.html#2012" class="Bound">s′</a> <a id="2015" class="Symbol">=</a> <a id="2017" href="Mealy.html#1989" class="Bound">f</a> <a id="2019" class="Symbol">(</a><a id="2020" href="Mealy.html#1994" class="Bound">a</a> <a id="2022" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2024" href="Mealy.html#1987" class="Bound">s</a><a id="2025" class="Symbol">)</a> <a id="2027" class="Keyword">in</a> <a id="2030" href="Mealy.html#2008" class="Bound">b</a> <a id="2032" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2034" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2036" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2042" href="Mealy.html#2012" class="Bound">s′</a> <a id="2045" href="Mealy.html#1989" class="Bound">f</a> <a id="2047" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2049" href="Mealy.html#1998" class="Bound">as</a>

  <a id="AsVecFun.⟦arr⟧"></a><a id="2055" href="Mealy.html#2055" class="Function">⟦arr⟧</a> <a id="2061" class="Symbol">:</a> <a id="2063" class="Symbol">∀</a> <a id="2065" class="Symbol">(</a><a id="2066" href="Mealy.html#2066" class="Bound">h</a> <a id="2068" class="Symbol">:</a> <a id="2070" href="Mealy.html#280" class="Generalizable">A</a> <a id="2072" class="Symbol">→</a> <a id="2074" href="Mealy.html#282" class="Generalizable">B</a><a id="2075" class="Symbol">)</a> <a id="2077" class="Symbol">→</a> <a id="2079" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2081" href="Mealy.html#640" class="Function">arr</a> <a id="2085" href="Mealy.html#2066" class="Bound">h</a> <a id="2087" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2089" href="VecFun.html#616" class="Function Operator">≗</a> <a id="2091" href="VecFun.html#732" class="Function">◇.arr</a> <a id="2097" href="Mealy.html#2066" class="Bound">h</a>
  <a id="2101" href="Mealy.html#2055" class="Function">⟦arr⟧</a> <a id="2107" href="Mealy.html#2107" class="Bound">h</a> <a id="2109" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="2112" class="Symbol">=</a> <a id="2114" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2121" href="Mealy.html#2055" class="Function">⟦arr⟧</a> <a id="2127" href="Mealy.html#2127" class="Bound">h</a> <a id="2129" class="Symbol">(</a><a id="2130" href="Mealy.html#2130" class="Bound">a</a> <a id="2132" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2134" href="Mealy.html#2134" class="Bound">as</a><a id="2136" class="Symbol">)</a> <a id="2138" class="Keyword">rewrite</a> <a id="2146" href="Mealy.html#2055" class="Function">⟦arr⟧</a> <a id="2152" href="Mealy.html#2127" class="Bound">h</a> <a id="2154" href="Mealy.html#2134" class="Bound">as</a> <a id="2157" class="Symbol">=</a> <a id="2159" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2167" class="Keyword">infixr</a> <a id="2174" class="Number">9</a> <a id="2176" href="Mealy.html#2184" class="Function Operator">_⟦∘⟧_</a>
  <a id="AsVecFun._⟦∘⟧_"></a><a id="2184" href="Mealy.html#2184" class="Function Operator">_⟦∘⟧_</a> <a id="2190" class="Symbol">:</a> <a id="2192" class="Symbol">∀</a> <a id="2194" class="Symbol">(</a><a id="2195" href="Mealy.html#2195" class="Bound">g</a> <a id="2197" class="Symbol">:</a> <a id="2199" href="Mealy.html#282" class="Generalizable">B</a> <a id="2201" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="2203" href="Mealy.html#284" class="Generalizable">C</a><a id="2204" class="Symbol">)</a> <a id="2206" class="Symbol">(</a><a id="2207" href="Mealy.html#2207" class="Bound">f</a> <a id="2209" class="Symbol">:</a> <a id="2211" href="Mealy.html#280" class="Generalizable">A</a> <a id="2213" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="2215" href="Mealy.html#282" class="Generalizable">B</a><a id="2216" class="Symbol">)</a> <a id="2218" class="Symbol">→</a> <a id="2220" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2222" href="Mealy.html#2195" class="Bound">g</a> <a id="2224" href="Mealy.html#773" class="Function Operator">∘</a> <a id="2226" href="Mealy.html#2207" class="Bound">f</a> <a id="2228" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2230" href="VecFun.html#616" class="Function Operator">≗</a> <a id="2232" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2234" href="Mealy.html#2195" class="Bound">g</a> <a id="2236" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2238" href="VecFun.html#805" class="Function Operator">◇.∘</a> <a id="2242" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2244" href="Mealy.html#2207" class="Bound">f</a> <a id="2246" href="Mealy.html#1929" class="Function Operator">⟧</a>
  <a id="2250" class="Symbol">(_</a> <a id="2253" href="Mealy.html#2184" class="Function Operator">⟦∘⟧</a> <a id="2257" class="Symbol">_)</a> <a id="2260" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="2263" class="Symbol">=</a> <a id="2265" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2272" class="Symbol">(</a><a id="2273" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2279" href="Mealy.html#2279" class="Bound">t</a> <a id="2281" href="Mealy.html#2281" class="Bound">g</a> <a id="2283" href="Mealy.html#2184" class="Function Operator">⟦∘⟧</a> <a id="2287" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2293" href="Mealy.html#2293" class="Bound">s</a> <a id="2295" href="Mealy.html#2295" class="Bound">f</a><a id="2296" class="Symbol">)</a> <a id="2298" class="Symbol">(</a><a id="2299" href="Mealy.html#2299" class="Bound">a</a> <a id="2301" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2303" href="Mealy.html#2303" class="Bound">as</a><a id="2305" class="Symbol">)</a>
    <a id="2311" class="Keyword">rewrite</a> <a id="2319" class="Symbol">(</a><a id="2320" class="Keyword">let</a> <a id="2324" href="Mealy.html#2324" class="Bound">b</a> <a id="2326" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2328" href="Mealy.html#2328" class="Bound">s′</a> <a id="2331" class="Symbol">=</a> <a id="2333" href="Mealy.html#2295" class="Bound">f</a> <a id="2335" class="Symbol">(</a><a id="2336" href="Mealy.html#2299" class="Bound">a</a> <a id="2338" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2340" href="Mealy.html#2293" class="Bound">s</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Symbol">;</a> <a id="2345" href="Mealy.html#2345" class="Bound">c</a> <a id="2347" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2349" href="Mealy.html#2349" class="Bound">t′</a> <a id="2352" class="Symbol">=</a> <a id="2354" href="Mealy.html#2281" class="Bound">g</a> <a id="2356" class="Symbol">(</a><a id="2357" href="Mealy.html#2324" class="Bound">b</a> <a id="2359" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2361" href="Mealy.html#2279" class="Bound">t</a><a id="2362" class="Symbol">)</a> <a id="2364" class="Keyword">in</a> 
              <a id="2382" class="Symbol">(</a><a id="2383" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2389" href="Mealy.html#2349" class="Bound">t′</a> <a id="2392" href="Mealy.html#2281" class="Bound">g</a> <a id="2394" href="Mealy.html#2184" class="Function Operator">⟦∘⟧</a> <a id="2398" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2404" href="Mealy.html#2328" class="Bound">s′</a> <a id="2407" href="Mealy.html#2295" class="Bound">f</a><a id="2408" class="Symbol">)</a> <a id="2410" href="Mealy.html#2303" class="Bound">as</a><a id="2412" class="Symbol">)</a> <a id="2414" class="Symbol">=</a> <a id="2416" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2424" class="Keyword">infixr</a> <a id="2431" class="Number">7</a> <a id="2433" href="Mealy.html#2441" class="Function Operator">_⟦⊗⟧_</a>
  <a id="AsVecFun._⟦⊗⟧_"></a><a id="2441" href="Mealy.html#2441" class="Function Operator">_⟦⊗⟧_</a> <a id="2447" class="Symbol">:</a> <a id="2449" class="Symbol">∀</a> <a id="2451" class="Symbol">(</a><a id="2452" href="Mealy.html#2452" class="Bound">f</a> <a id="2454" class="Symbol">:</a> <a id="2456" href="Mealy.html#280" class="Generalizable">A</a> <a id="2458" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="2460" href="Mealy.html#284" class="Generalizable">C</a><a id="2461" class="Symbol">)</a> <a id="2463" class="Symbol">(</a><a id="2464" href="Mealy.html#2464" class="Bound">g</a> <a id="2466" class="Symbol">:</a> <a id="2468" href="Mealy.html#282" class="Generalizable">B</a> <a id="2470" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="2472" href="Mealy.html#286" class="Generalizable">D</a><a id="2473" class="Symbol">)</a> <a id="2475" class="Symbol">→</a> <a id="2477" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2479" href="Mealy.html#2452" class="Bound">f</a> <a id="2481" href="Mealy.html#992" class="Function Operator">⊗</a> <a id="2483" href="Mealy.html#2464" class="Bound">g</a> <a id="2485" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2487" href="VecFun.html#616" class="Function Operator">≗</a> <a id="2489" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2491" href="Mealy.html#2452" class="Bound">f</a> <a id="2493" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2495" href="VecFun.html#893" class="Function Operator">◇.⊗</a> <a id="2499" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2501" href="Mealy.html#2464" class="Bound">g</a> <a id="2503" href="Mealy.html#1929" class="Function Operator">⟧</a>
  <a id="2507" class="Symbol">(_</a> <a id="2510" href="Mealy.html#2441" class="Function Operator">⟦⊗⟧</a> <a id="2514" class="Symbol">_)</a> <a id="2517" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="2520" class="Symbol">=</a> <a id="2522" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2529" class="Symbol">(</a><a id="2530" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2536" href="Mealy.html#2536" class="Bound">s</a> <a id="2538" href="Mealy.html#2538" class="Bound">f</a> <a id="2540" href="Mealy.html#2441" class="Function Operator">⟦⊗⟧</a> <a id="2544" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2550" href="Mealy.html#2550" class="Bound">t</a> <a id="2552" href="Mealy.html#2552" class="Bound">g</a><a id="2553" class="Symbol">)</a> <a id="2555" class="Symbol">((</a><a id="2557" href="Mealy.html#2557" class="Bound">a</a> <a id="2559" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2561" href="Mealy.html#2561" class="Bound">b</a><a id="2562" class="Symbol">)</a> <a id="2564" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2566" href="Mealy.html#2566" class="Bound">abs</a><a id="2569" class="Symbol">)</a>
    <a id="2575" class="Keyword">rewrite</a> <a id="2583" class="Symbol">(</a><a id="2584" class="Keyword">let</a> <a id="2588" href="Mealy.html#2588" class="Bound">c</a> <a id="2590" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2592" href="Mealy.html#2592" class="Bound">s′</a> <a id="2595" class="Symbol">=</a> <a id="2597" href="Mealy.html#2538" class="Bound">f</a> <a id="2599" class="Symbol">(</a><a id="2600" href="Mealy.html#2557" class="Bound">a</a> <a id="2602" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2604" href="Mealy.html#2536" class="Bound">s</a><a id="2605" class="Symbol">)</a> <a id="2607" class="Symbol">;</a> <a id="2609" href="Mealy.html#2609" class="Bound">d</a> <a id="2611" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2613" href="Mealy.html#2613" class="Bound">t′</a> <a id="2616" class="Symbol">=</a> <a id="2618" href="Mealy.html#2552" class="Bound">g</a> <a id="2620" class="Symbol">(</a><a id="2621" href="Mealy.html#2561" class="Bound">b</a> <a id="2623" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2625" href="Mealy.html#2550" class="Bound">t</a><a id="2626" class="Symbol">)</a> <a id="2628" class="Keyword">in</a> 
              <a id="2646" class="Symbol">(</a><a id="2647" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2653" href="Mealy.html#2592" class="Bound">s′</a> <a id="2656" href="Mealy.html#2538" class="Bound">f</a> <a id="2658" href="Mealy.html#2441" class="Function Operator">⟦⊗⟧</a> <a id="2662" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="2668" href="Mealy.html#2613" class="Bound">t′</a> <a id="2671" href="Mealy.html#2552" class="Bound">g</a><a id="2672" class="Symbol">)</a> <a id="2674" href="Mealy.html#2566" class="Bound">abs</a><a id="2677" class="Symbol">)</a> <a id="2679" class="Symbol">=</a> <a id="2681" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="2689" class="Comment">-- infixr 7 _⟦⊕⟧_</a>
  <a id="2709" class="Comment">-- _⟦⊕⟧_ : ∀ (f : A ⇨ C) (g : B ⇨ D) → ⟦ f ⊕ g ⟧ ≗ ⟦ f ⟧ ◇.⊕ ⟦ g ⟧</a>
  <a id="2778" class="Comment">-- f ⟦⊕⟧ g = ?</a>

  <a id="AsVecFun.⟦delay⟧"></a><a id="2796" href="Mealy.html#2796" class="Function">⟦delay⟧</a> <a id="2804" class="Symbol">:</a> <a id="2806" class="Symbol">(</a><a id="2807" href="Mealy.html#2807" class="Bound">a₀</a> <a id="2810" class="Symbol">:</a> <a id="2812" href="Mealy.html#280" class="Generalizable">A</a><a id="2813" class="Symbol">)</a> <a id="2815" class="Symbol">→</a> <a id="2817" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2819" href="Mealy.html#1506" class="Function">delay</a> <a id="2825" href="Mealy.html#2807" class="Bound">a₀</a> <a id="2828" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2830" href="VecFun.html#616" class="Function Operator">≗</a> <a id="2832" href="VecFun.html#1197" class="Function">◇.delay</a> <a id="2840" href="Mealy.html#2807" class="Bound">a₀</a>
  <a id="2845" href="Mealy.html#2796" class="Function">⟦delay⟧</a> <a id="2853" href="Mealy.html#2853" class="Bound">a₀</a> <a id="2856" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="2859" class="Symbol">=</a> <a id="2861" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="2868" href="Mealy.html#2796" class="Function">⟦delay⟧</a> <a id="2876" href="Mealy.html#2876" class="Bound">a₀</a> <a id="2879" class="Symbol">(</a><a id="2880" href="Mealy.html#2880" class="Bound">a</a> <a id="2882" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2884" href="Mealy.html#2884" class="Bound">as</a><a id="2886" class="Symbol">)</a> <a id="2888" class="Symbol">=</a>
    <a id="2894" href="Relation.Binary.PropositionalEquality.Core.html#2849" class="Function Operator">begin</a>
      <a id="2906" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2908" href="Mealy.html#1506" class="Function">delay</a> <a id="2914" href="Mealy.html#2876" class="Bound">a₀</a> <a id="2917" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2919" class="Symbol">(</a><a id="2920" href="Mealy.html#2880" class="Bound">a</a> <a id="2922" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2924" href="Mealy.html#2884" class="Bound">as</a><a id="2926" class="Symbol">)</a>
    <a id="2932" href="Relation.Binary.PropositionalEquality.Core.html#2907" class="Function Operator">≡⟨⟩</a>
      <a id="2942" href="Mealy.html#2876" class="Bound">a₀</a> <a id="2945" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="2947" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="2949" href="Mealy.html#1506" class="Function">delay</a> <a id="2955" href="Mealy.html#2880" class="Bound">a</a> <a id="2957" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="2959" href="Mealy.html#2884" class="Bound">as</a>
    <a id="2966" href="Relation.Binary.PropositionalEquality.Core.html#2966" class="Function">≡⟨</a> <a id="2969" href="Relation.Binary.PropositionalEquality.Core.html#1173" class="Function">cong</a> <a id="2974" class="Symbol">(</a><a id="2975" href="Mealy.html#2876" class="Bound">a₀</a> <a id="2978" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷_</a><a id="2980" class="Symbol">)</a> <a id="2982" class="Symbol">(</a><a id="2983" href="Mealy.html#2796" class="Function">⟦delay⟧</a> <a id="2991" href="Mealy.html#2880" class="Bound">a</a> <a id="2993" href="Mealy.html#2884" class="Bound">as</a><a id="2995" class="Symbol">)</a> <a id="2997" href="Relation.Binary.PropositionalEquality.Core.html#2966" class="Function">⟩</a>
      <a id="3005" href="Mealy.html#2876" class="Bound">a₀</a> <a id="3008" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="3010" href="VecFun.html#1197" class="Function">◇.delay</a> <a id="3018" href="Mealy.html#2880" class="Bound">a</a> <a id="3020" href="Mealy.html#2884" class="Bound">as</a>
    <a id="3027" href="Relation.Binary.PropositionalEquality.Core.html#3053" class="Function">≡˘⟨</a> <a id="3031" href="VecFun.html#3104" class="Function">◇.delay∷</a> <a id="3040" href="Relation.Binary.PropositionalEquality.Core.html#3053" class="Function">⟩</a>
      <a id="3048" href="VecFun.html#1197" class="Function">◇.delay</a> <a id="3056" href="Mealy.html#2876" class="Bound">a₀</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Mealy.html#2880" class="Bound">a</a> <a id="3062" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="3064" href="Mealy.html#2884" class="Bound">as</a><a id="3066" class="Symbol">)</a>
    <a id="3072" href="Relation.Binary.PropositionalEquality.Core.html#3148" class="Function Operator">∎</a>

  <a id="AsVecFun.⟦scanl⟧"></a><a id="3077" href="Mealy.html#3077" class="Function">⟦scanl⟧</a> <a id="3085" class="Symbol">:</a> <a id="3087" class="Symbol">∀</a> <a id="3089" class="Symbol">(</a><a id="3090" href="Mealy.html#3090" class="Bound">f</a> <a id="3092" class="Symbol">:</a> <a id="3094" href="Mealy.html#282" class="Generalizable">B</a> <a id="3096" class="Symbol">→</a> <a id="3098" href="Mealy.html#280" class="Generalizable">A</a> <a id="3100" class="Symbol">→</a> <a id="3102" href="Mealy.html#282" class="Generalizable">B</a><a id="3103" class="Symbol">)</a> <a id="3105" class="Symbol">→</a> <a id="3107" class="Symbol">(</a><a id="3108" href="Mealy.html#3108" class="Bound">s₀</a> <a id="3111" class="Symbol">:</a> <a id="3113" href="Mealy.html#282" class="Generalizable">B</a><a id="3114" class="Symbol">)</a> <a id="3116" class="Symbol">→</a> <a id="3118" href="Mealy.html#1929" class="Function Operator">⟦</a> <a id="3120" href="Mealy.html#1608" class="Function">scanl</a> <a id="3126" href="Mealy.html#3090" class="Bound">f</a> <a id="3128" href="Mealy.html#3108" class="Bound">s₀</a> <a id="3131" href="Mealy.html#1929" class="Function Operator">⟧</a> <a id="3133" href="VecFun.html#616" class="Function Operator">≗</a> <a id="3135" href="VecFun.html#1300" class="Function">◇.scanl</a> <a id="3143" href="Mealy.html#3090" class="Bound">f</a> <a id="3145" href="Mealy.html#3108" class="Bound">s₀</a>
  <a id="3150" href="Mealy.html#3077" class="Function">⟦scanl⟧</a> <a id="3158" href="Mealy.html#3158" class="Bound">f</a> <a id="3160" href="Mealy.html#3160" class="Bound">s₀</a> <a id="3163" href="Data.Vec.Base.html#995" class="InductiveConstructor">[]</a> <a id="3166" class="Symbol">=</a> <a id="3168" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
  <a id="3175" href="Mealy.html#3077" class="Function">⟦scanl⟧</a> <a id="3183" href="Mealy.html#3183" class="Bound">f</a> <a id="3185" href="Mealy.html#3185" class="Bound">s₀</a> <a id="3188" class="Symbol">(</a><a id="3189" href="Mealy.html#3189" class="Bound">a</a> <a id="3191" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">∷</a> <a id="3193" href="Mealy.html#3193" class="Bound">as</a><a id="3195" class="Symbol">)</a> <a id="3197" class="Keyword">rewrite</a> <a id="3205" href="Mealy.html#3077" class="Function">⟦scanl⟧</a> <a id="3213" href="Mealy.html#3183" class="Bound">f</a> <a id="3215" class="Symbol">(</a><a id="3216" href="Mealy.html#3183" class="Bound">f</a> <a id="3218" href="Mealy.html#3185" class="Bound">s₀</a> <a id="3221" href="Mealy.html#3189" class="Bound">a</a><a id="3222" class="Symbol">)</a> <a id="3224" href="Mealy.html#3193" class="Bound">as</a> <a id="3227" class="Symbol">=</a> <a id="3229" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="3235" class="Comment">-- Specification via denotational homomorphisms</a>
<a id="3283" class="Keyword">module</a> <a id="AsStreamFun"></a><a id="3290" href="Mealy.html#3290" class="Module">AsStreamFun</a> <a id="3302" class="Keyword">where</a>

  <a id="3311" class="Keyword">open</a> <a id="3316" class="Keyword">import</a> <a id="3323" href="Data.Nat.html" class="Module">Data.Nat</a>
  <a id="3334" class="Keyword">open</a> <a id="3339" class="Keyword">import</a> <a id="3346" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="3384" class="Keyword">hiding</a> <a id="3391" class="Symbol">(</a><a id="3392" href="Relation.Binary.PropositionalEquality.html#1471" class="Function Operator">_≗_</a><a id="3395" class="Symbol">)</a>
  <a id="3399" class="Keyword">open</a> <a id="3404" href="Relation.Binary.PropositionalEquality.Core.html#2751" class="Module">≡-Reasoning</a>

  <a id="3419" class="Keyword">import</a> <a id="3426" href="StreamFun.html" class="Module">StreamFun</a> <a id="3436" class="Symbol">as</a> <a id="3439" class="Module">◇</a>
  <a id="3443" class="Keyword">open</a> <a id="3448" href="StreamFun.html" class="Module">◇</a> <a id="3450" class="Keyword">using</a> <a id="3456" class="Symbol">(</a><a id="3457" href="StreamFun.html#479" class="Record">Stream</a><a id="3463" class="Symbol">;</a> <a id="3465" href="StreamFun.html#1765" class="Function Operator">_↠_</a><a id="3468" class="Symbol">;</a> <a id="3470" href="StreamFun.html#618" class="Record Operator">_≈_</a><a id="3473" class="Symbol">;</a> <a id="3475" href="StreamFun.html#1828" class="Function Operator">_≗_</a><a id="3478" class="Symbol">)</a>
  <a id="3482" class="Keyword">open</a> <a id="3487" href="StreamFun.html#479" class="Module">Stream</a> <a id="3494" class="Symbol">;</a> <a id="3496" class="Keyword">open</a> <a id="3501" href="StreamFun.html#618" class="Module Operator">_≈_</a>

  <a id="AsStreamFun.⟦_⟧"></a><a id="3508" href="Mealy.html#3508" class="Function Operator">⟦_⟧</a> <a id="3512" class="Symbol">:</a> <a id="3514" class="Symbol">(</a><a id="3515" href="Mealy.html#280" class="Generalizable">A</a> <a id="3517" href="Mealy.html#442" class="Record Operator">⇨</a> <a id="3519" href="Mealy.html#282" class="Generalizable">B</a><a id="3520" class="Symbol">)</a> <a id="3522" class="Symbol">→</a> <a id="3524" class="Symbol">(</a><a id="3525" href="Mealy.html#280" class="Generalizable">A</a> <a id="3527" href="StreamFun.html#1765" class="Function Operator">↠</a> <a id="3529" href="Mealy.html#282" class="Generalizable">B</a><a id="3530" class="Symbol">)</a>
  <a id="3534" href="Mealy.html#3508" class="Function Operator">⟦</a> <a id="3536" href="Mealy.html#485" class="InductiveConstructor">mealy</a> <a id="3542" href="Mealy.html#3542" class="Bound">s</a> <a id="3544" href="Mealy.html#3544" class="Bound">f</a> <a id="3546" href="Mealy.html#3508" class="Function Operator">⟧</a> <a id="3548" class="Symbol">=</a> <a id="3550" href="StreamFun.html#2745" class="Function">◇.mealy</a> <a id="3558" href="Mealy.html#3542" class="Bound">s</a> <a id="3560" href="Mealy.html#3544" class="Bound">f</a>

  <a id="3565" class="Comment">-- ⟦arr⟧ : ∀ (h : A → B) → ⟦ arr h ⟧ ≗ ◇.arr h</a>
  <a id="3614" class="Comment">-- hd-≈ (⟦arr⟧ h as) = refl</a>
  <a id="3644" class="Comment">-- tl-≈ (⟦arr⟧ h as) = {!!}</a>

  <a id="3675" class="Comment">-- ⟦arr⟧ h [] = refl</a>
  <a id="3698" class="Comment">-- ⟦arr⟧ h (a ∷ as) rewrite ⟦arr⟧ h as = refl</a>

  <a id="3747" class="Comment">-- infixr 9 _⟦∘⟧_</a>
  <a id="3767" class="Comment">-- _⟦∘⟧_ : ∀ (g : B ⇨ C) (f : A ⇨ B) → ⟦ g ∘ f ⟧ ≗ ⟦ g ⟧ ◇.∘ ⟦ f ⟧</a>
  <a id="3836" class="Comment">-- (_ ⟦∘⟧ _) [] = refl</a>
  <a id="3861" class="Comment">-- (mealy t g ⟦∘⟧ mealy s f) (a ∷ as)</a>
  <a id="3901" class="Comment">--   rewrite (let b , s′ = f (a , s) ; c , t′ = g (b , t) in </a>
  <a id="3965" class="Comment">--             (mealy t′ g ⟦∘⟧ mealy s′ f) as) = refl</a>

  <a id="4022" class="Comment">-- infixr 7 _⟦⊗⟧_</a>
  <a id="4042" class="Comment">-- _⟦⊗⟧_ : ∀ (f : A ⇨ C) (g : B ⇨ D) → ⟦ f ⊗ g ⟧ ≗ ⟦ f ⟧ ◇.⊗ ⟦ g ⟧</a>
  <a id="4111" class="Comment">-- (_ ⟦⊗⟧ _) [] = refl</a>
  <a id="4136" class="Comment">-- (mealy s f ⟦⊗⟧ mealy t g) ((a , b) ∷ abs)</a>
  <a id="4183" class="Comment">--   rewrite (let c , s′ = f (a , s) ; d , t′ = g (b , t) in </a>
  <a id="4247" class="Comment">--             (mealy s′ f ⟦⊗⟧ mealy t′ g) abs) = refl</a>

  <a id="4305" class="Comment">-- -- infixr 7 _⟦⊕⟧_</a>
  <a id="4328" class="Comment">-- -- _⟦⊕⟧_ : ∀ (f : A ⇨ C) (g : B ⇨ D) → ⟦ f ⊕ g ⟧ ≗ ⟦ f ⟧ ◇.⊕ ⟦ g ⟧</a>
  <a id="4400" class="Comment">-- -- f ⟦⊕⟧ g = ?</a>

  <a id="4421" class="Comment">-- ⟦delay⟧ : (a₀ : A) → ⟦ delay a₀ ⟧ ≗ ◇.delay a₀</a>
  <a id="4473" class="Comment">-- ⟦delay⟧ a₀ [] = refl</a>
  <a id="4499" class="Comment">-- ⟦delay⟧ a₀ (a ∷ as) =</a>
  <a id="4526" class="Comment">--   begin</a>
  <a id="4539" class="Comment">--     ⟦ delay a₀ ⟧ (a ∷ as)</a>
  <a id="4570" class="Comment">--   ≡⟨⟩</a>
  <a id="4581" class="Comment">--     a₀ ∷ ⟦ delay a ⟧ as</a>
  <a id="4610" class="Comment">--   ≡⟨ cong (a₀ ∷_) (⟦delay⟧ a as) ⟩</a>
  <a id="4650" class="Comment">--     a₀ ∷ ◇.delay a as</a>
  <a id="4677" class="Comment">--   ≡˘⟨ ◇.delay∷ ⟩</a>
  <a id="4699" class="Comment">--     ◇.delay a₀ (a ∷ as)</a>
  <a id="4728" class="Comment">--   ∎</a>

  <a id="4738" class="Comment">-- ⟦scanlV⟧ : ∀ (f : B → A → B) → (s₀ : B) → ⟦ scanlV f s₀ ⟧ ≗ ◇.scanlV f s₀</a>
  <a id="4817" class="Comment">-- ⟦scanlV⟧ f s₀ [] = refl</a>
  <a id="4846" class="Comment">-- ⟦scanlV⟧ f s₀ (a ∷ as) rewrite ⟦scanlV⟧ f (f s₀ a) as = refl</a>
</pre></body></html>